<!DOCTYPE html>
<html>
<head>
  <title>Janet & Malcolm</title>
  <link href="https://fonts.googleapis.com/css?family=Cutive+Mono" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    #header {
      text-align: center;
      margin-top: 3em;
      padding: 1em;

    }
    .strip {
      background-image: url("goldstrip.jpg");
      background-size: cover;
      width: 100%;
      padding: 0.1em;
      margin-bottom: 2em;
    }
    body {
      background-color: #F2F4F3;
      font-family: 'Cutive Mono', monospace;
      font-size: 1.75em;
      color: #2E2F2F;
      z-index: 1;
      margin: 0;
      padding: 0;
    }
    hr {
      border-top: 1px solid #2E2F2F;
      width: 80%;
    }
    canvas {
      position: absolute;
    }
    canvas {
      z-index: 0;
      top: 0;
    }
    #display {
      position: fixed;
      z-index: 2;
      pointer-events: none;
    }
    @media (min-width: 768px) {
      #everything  {
        margin: 1em 6em 2em 6em;
        max-width: 30em;
        margin: auto;
      }
    }
    @media (max-width: 768px) {
      #everything {
        margin: 1em;
      }
    }
    .hidden {
      display: none;
    }
    .question:after {
      content: '';
      background: url("down.png");
      background-size: contain;
      background-repeat: no-repeat;
      background-position-y: 0.4em;
      width: 0.8em;
      height: 0.8em;
      display: inline-block;
    }
    .question {
      font-weight: bold;
      padding-top: 1em;
      cursor: pointer;
    }
    #tandc {
      font-weight: bold;
      font-size: 0.7em;
      margin-bottom: 1em;
      text-align: center;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <canvas id="display"></canvas>
  <div id="everything">
    <div id="header">Janet and Malcolm are getting married at Waterfall Bay in the Marlborough Sounds!</div>
    <div class="strip"></div>
    <div class="content">
      <p>
          You're invited to join us at the Picton foreshore at <b>midday 28th September</b> for the
          boat-trip-wedding-sleepover-phosphorescence-party in the Marlborough Sounds!
      </p>
      <p>
          Wear something that's smart and comfy as you'll be cutting some shapes on the dance floor later.
      </p>
    </div>
    <div class="content">
      <div>Frequently Asked Questions</div>

      <div class="question">Will there be phosphorescence?</div>
      <div class="answer hidden">
        Excellent question - we hope so. Rumour has it there is a good chance - bring your togs!
      </div>

      <div class="question">Smart and comfy dress!? More details please!</div>
      <div class="answer hidden">
        We'd love it if you wear or bring a little sparkle for the reception (eg: sparkly hat, glasses, dress), but other than
        that just wear something comfy that's a bit fancy. The surroundings will be grass and beach and we'll dance into the 
        evening so it could get chilly later. Fingers crossed for no rain, but if it does, there will be a wet weather option.
      </div>
      
      <div class="question">Sleepover?</div>
      <div class="answer hidden">
        We want to spend as much time with you all as possible, so we've booked out Mistletoe Bay (just around the bay from
        Waterfall bay) for the wedding guests to stay.  We wanted to all stay in one place so Sunday we can have a relaxed day 
        together.  Once we have final numbers we will contact you with the sleeping arrangements, but we have a 
        <a href="http://www.mistletoebay.co.nz/zones/Accommodation/">range of options</a>.
        Costs range from $18 to approx $35per person per night. Let us know if you have any special requirements in the form below.
      </div>
      
      <div class="question">How will the day run?</div>
      <div class="answer hidden">
          <p>(Approximate timings, we will update this once finalised)</p>

          <p>
            <b>Saturday 28th September</b><br>
            <b>Midday</b> Arrive at Picton foreshore <a href="https://goo.gl/maps/3Ns6QX4AYCE2">at the wharf</a> for a boat ride to Mistletoe Bay<br>
            <b>1pm</b> Arrive at Mistletoe Bay to setup in your accomodation<br>
            <b>2.30pm</b> We've arranged transport to take you to Waterfall Bay for the ceremony<br>
            <b>3.30pm</b> Ceremony starts<br>
            <b>4pm</b> Snacks and drinks begin<br>
            <b>6pm</b> Dinner <br>
            <b>Midnight</b> transport back to Mistletoe bay
          </p>
          
          <p>
            <b>Sunday 29th September</b><br>
            <b>Late morning</b> We will put on a brunch midmorning, but suggest you bring some extra food too in case of early risers<br>
            <b>3pm</b> Boat leaves Mistletoe Bay back to Picton<br>
            <b>4pm</b> Arrive back at Picton foreshore
          </p>
      </div>
      
      <div class="question">Psst...Dinner and drinks?</div>
      <div class="answer hidden">
        There will be cheese boards snacks after the ceremony and into the evening. And a cocktail menu for the dinner, brought to
        you by one of Marlborough's best (and most lovely) chefs full of proudly sourced local ingredients.
      </div>
      
      <div class="question">How do I get to Picton?</div>
      <div class="answer hidden">
        <p>
          International guests: Flying to <a href="https://goo.gl/maps/6ce7yjgy5pw">Wellington</a> (beautiful capital city of NZ)
          to then connect to Picton is your best bet.
        </p>

        <p>
          Once in Wellington, you have a few options:
          <ol>
            <li>Internal flight (Jetstar or AirNZ - see <a href="https://flights.google.com">flights.google.com</a>)</li>
            <li><a href="https://www.soundsair.com/">Soundsair</a> (tiny flight that is around $70 and quite the kiwi experience. If you're lucky, you'll get to see the Marlborough Sounds at sunset by air. Not recommended for nervous flyers).</li>
            <li><a href="https://www.greatjourneysofnz.co.nz/interislander">The Interislander</a> - ferry that crosses the cook strait. 3-4 hour trip and beautiful views. Can go by foot or take your car.</li>
          </ol>
        </p>
      </div>

      <div class="question">What's the plan for kids?</div>
      <div class="answer hidden">
          We love all the tiny people in our lives and would love them to join the ceremony at Waterfall Bay. If you'd like to bring
          your kids they would be with you for the ceremony and we will have a babysitter for the rest of the evening in a cottage
          nearby. If you need more details, or have special requirements send us a message in the form above, or to either Malcolm or
          Janet and we will try to support however we can. 
      </div>

      <div class="question">What will we do on Sunday?</div>
      <div class="answer hidden">
          We’ll have a slow brunch and wanted to spend some proper time with everyone, enjoying the surrounds of Mistletoe Bay and
          the beautiful Marlborough Sounds so have the larger part of the day there. There are plenty of local walks, kayaks and
          paddle boards to keep the more adventurous ones busy. We’ll be back in Picton by 4pm so those who need to fly out for
          work can do so, but we’ll be around Monday and would love to spend time with anyone staying on. 
      </div>

      <div class="question">September?!</div>
      <div class="answer hidden">
          Apologies about the late notice. We got inspired to have a wedding but didn't want the organising to take over our lives,
          so decided to lock it in this September. We hope you can make it! 
      </div>

      <iframe id="JotFormIFrame-90221138204847" allowtransparency="true" src="https://form.jotform.co/90221138204847" frameborder="0" style="width: 1px; min-width: 100%; height:539px; border:none;" scrolling="no" > </iframe> <script type="text/javascript"> var ifr = document.getElementById("JotFormIFrame-90221138204847"); if(window.location.href && window.location.href.indexOf("?") > -1) { var get = window.location.href.substr(window.location.href.indexOf("?") + 1); if(ifr && get.length > 0) { var src = ifr.src; src = src.indexOf("?") > -1 ? src + "&" + get : src + "?" + get; ifr.src = src; } } window.handleIFrameMessage = function(e) { if (typeof e.data === 'object') { return; } var args = e.data.split(":"); if (args.length > 2) { iframe = document.getElementById("JotFormIFrame-" + args[(args.length - 1)]); } else { iframe = document.getElementById("JotFormIFrame"); } if (!iframe) { return; } switch (args[0]) { case "scrollIntoView": iframe.scrollIntoView(); break; case "setHeight": iframe.style.height = args[1] + "px"; break; case "collapseErrorPage": if (iframe.clientHeight > window.innerHeight) { iframe.style.height = window.innerHeight + "px"; } break; case "reloadPage": window.location.reload(); break; case "loadScript": var src = args[1]; if (args.length > 3) { src = args[1] + ':' + args[2]; } var script = document.createElement('script'); script.src = src; script.type = 'text/javascript'; document.body.appendChild(script); break; case "exitFullscreen": if (window.document.exitFullscreen) window.document.exitFullscreen(); else if (window.document.mozCancelFullScreen) window.document.mozCancelFullScreen(); else if (window.document.mozCancelFullscreen) window.document.mozCancelFullScreen(); else if (window.document.webkitExitFullscreen) window.document.webkitExitFullscreen(); else if (window.document.msExitFullscreen) window.document.msExitFullscreen(); break; } var isJotForm = (e.origin.indexOf("jotform") > -1) ? true : false; if(isJotForm && "contentWindow" in iframe && "postMessage" in iframe.contentWindow) { var urls = {"docurl":encodeURIComponent(document.URL),"referrer":encodeURIComponent(document.referrer)}; iframe.contentWindow.postMessage(JSON.stringify({"type":"urls","value":urls}), "*"); } }; if (window.addEventListener) { window.addEventListener("message", handleIFrameMessage, false); } else if (window.attachEvent) { window.attachEvent("onmessage", handleIFrameMessage); } </script>

      <div id="tandc">
        Terms & Conditions
        <div>
          <iframe class="hidden" src="https://giphy.com/embed/xTiTnEHBh7qapyuvwQ" width="480" height="392" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
        </div>
      </div>
    </div>
  </div>

  <script>
    // adapted from https://github.com/hunterloftis/playfuljs-demos/blob/gh-pages/particles/index.html
    var DAMPING = 0.999;
    var GRAVITY = 0.0005;
    var EXPLOSION = { x: 0.02, y: -0.04 }
    var PARTICLES = 200;
    var GROW_SPEED = 0.1;
    var GLITTER_CHANCE = 0;
    var MAX_AGE = 200;
    var SIZE = 3;
    var frameCount = 0;
    var FRAMES_PER_GLITTER = 4;

    function Particle(x, y, velocity, colour) {
      this.velocity = velocity;
      this.x = x;
      this.y = y;
      this.colour = colour;
      this.size = SIZE;
      this.age = 0;
      this.points = []
    }

    Particle.prototype.grow = function() {
      this.size += GROW_SPEED;
    }

    Particle.prototype.bounce = function() {
      if (this.x < 0 || this.x > width) {
        this.velocity.x = -this.velocity.x;
      }
    }

    Particle.prototype.integrate = function() {
      this.velocity.x *= DAMPING;
      this.velocity.y *= DAMPING;
      this.x += this.velocity.x;
      this.y += this.velocity.y;
    };

    Particle.prototype.gravity = function() {
      this.velocity.y += height * GRAVITY;
    };

    Particle.prototype.draw = function() {
      if (Math.random() * 100 < GLITTER_CHANCE) {
        //strokeStar(this.x, this.y, this.size * 0.6, 8, this.size * 0.5);
        ctx.fillStyle = "#fff";
      } else {
        ctx.fillStyle = this.colour;
      }
      if (frameCount % FRAMES_PER_GLITTER == 0) {
        this.points = [];
        for (var i = 0; i < 3; ++i) {
          var point = this.randomNearPoint(this.size);
          this.points.push(point);
        }
      }
      ctx.lineWidth = 2;
      ctx.strokeStyle = "#dbb030"
      ctx.beginPath();
      for (var i = 0; i < this.points.length; ++i) {
        ctx.lineTo(this.x + this.points[i].x, this.y + this.points[i].y);
      }
      ctx.closePath();
      ctx.stroke();
      ctx.fill();
    };

    Particle.prototype.randomNearPoint = function(radius) {
      var angle = Math.random() * Math.PI * 2;
      var x = Math.cos(angle) * radius;
      var y = Math.sin(angle) * radius;
      return { x: x, y: y };
    }

    Particle.prototype.isDead = function() {
      this.age++;
      return this.age > MAX_AGE;
    }

    var display = document.getElementById('display');
    var ctx = display.getContext('2d');
    var particles = [];
    var width = display.width = window.innerWidth;
    var height = display.height = window.innerHeight;

    fireConfetti();

    document.getElementById('header').addEventListener('mouseover', fireConfetti);
    document.getElementById('everything').addEventListener('touchstart', fireConfetti);
    document.getElementById('everything').addEventListener('mousedown', fireConfetti);

    function fireConfetti() {
      var source = { x: width/2, y: height }
      for (var i = 0; i < PARTICLES; i++) {
        var velocity = { 
          x: Math.random() * width * EXPLOSION.x - width * EXPLOSION.x * 0.5,
          y: Math.random() * height * EXPLOSION.y
        }
        var colour = randomColour(PARTICLES, i);
        particles.push(new Particle(source.x, source.y, velocity, colour));
      }
    }

    // from https://stackoverflow.com/a/45140101/281657
    function strokeStar(x, y, r, n, inset) {
      ctx.save();
      ctx.beginPath();
      ctx.translate(x, y);
      ctx.moveTo(0,0-r);
      for (var i = 0; i < n; i++) {
          ctx.rotate(Math.PI / n);
          ctx.lineTo(0, 0 - (r*inset));
          ctx.rotate(Math.PI / n);
          ctx.lineTo(0, 0 - r);
      }
      ctx.closePath();
      ctx.fill();
      ctx.restore();
    }

    // from https://stackoverflow.com/a/7419630/281657
    function randomColour(numOfSteps, step) {
      var colour = Math.random();
      if (colour < 0.33) {
        return "#F9D68C"
      } else if (colour < 0.66) {
        return "#D5AA74"
      } else {
        return "#fff1d3"
      }
    }

    requestAnimationFrame(frame);

    function frame() {
      frameCount++;
      requestAnimationFrame(frame);
      ctx.clearRect(0, 0, width, height);
      for (var i = 0; i < particles.length; i++) {
        particles[i].gravity();
        particles[i].bounce();
        particles[i].grow();
        particles[i].integrate();
        particles[i].draw();
        if (particles[i].isDead()) {
          particles.splice(i, 1);
        }
      }
    }

    // FAQ click handling
    document.querySelectorAll(".question").forEach(function(question) {
      question.addEventListener("mousedown", function() {
        document.querySelectorAll(".answer").forEach(function(answer) {
          if (answer === question.nextElementSibling && answer.classList.contains("hidden")) {
            answer.classList.remove("hidden");
          } else if (!answer.classList.contains("hidden")) {
            answer.classList.add("hidden");
          }
        });
      });
    });

    document.querySelector("#tandc").addEventListener("mousedown", function(el) {
      document.querySelector("#tandc iframe").classList.remove("hidden");
    })
  </script>
</body>
</html>